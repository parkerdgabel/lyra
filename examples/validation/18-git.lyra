(*
  18-git.lyra â€” Git stdlib API quick validation
  Run: lyra-runner --file examples/validation/18-git.lyra
*)

tmp := "target/tmp/git-demo";
MakeDirectory[tmp, <|"Parents"->True|>];

(* create a file *)
WriteBytes[tmp<>"/README.md", "Hello git\n"];

(* init repo, add, commit *)
GitInit[<|"Path"->tmp, "InitialBranch"->"main"|>];
GitStatus[<|"Cwd"->tmp|>];
GitAdd["README.md", <|"Cwd"->tmp|>];
GitCommit["init", <|"Cwd"->tmp|>];

GitCurrentBranch[<|"Cwd"->tmp|>];
GitBranchList[<|"Cwd"->tmp|>];
GitLog[<|"Cwd"->tmp, "Limit"->3|>];

(* update file and show diff *)
WriteBytes[tmp<>"/README.md", "Hello git, updated!\n"];
GitDiff[<|"Cwd"->tmp, "Base"->"HEAD", "Paths"->{"README.md"}|>];
GitAdd[{"README.md"}, <|"Cwd"->tmp|>];
GitCommit["update", <|"Cwd"->tmp|>];

GitStatus[<|"Cwd"->tmp|>];

